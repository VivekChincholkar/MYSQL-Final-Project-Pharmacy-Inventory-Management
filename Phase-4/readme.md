## üìä SQL Project Phase 4 ‚Äì Advanced SQL Operations (Pharmacy Database)

## üîç Overview
This phase of the SQL project demonstrates **advanced database operations** across multiple pharmacy-related tables (Suppliers, Categories, Manufacturers, Products, Inventory, Customers, Prescriptions, Sales, Employees, etc.).  
Each table includes **~20 queries** covering:

- Views  
- Common Table Expressions (CTEs)  
- Stored Procedures  
- Data Control Language (DCL)  
- Transaction Control Language (TCL)  
- Triggers  
- Window Functions  

These queries simulate **real-world pharmacy management tasks** such as supplier tracking, product pricing, stock management, customer handling, and prescription processing.

---

## üß© Topics Covered

### 1. **Views**
Reusable query definitions presenting meaningful business insights, e.g.:
- Active suppliers and recent registrations  
- Inventory low-stock alerts  
- Customer prescription histories  
- High-value sales reports  

### 2. **CTEs (Common Table Expressions)**
Readable modular queries for:
- Average order amounts by supplier  
- Product stock aggregation  
- Ranking prescriptions by date  
- Customer spending analysis  

### 3. **Stored Procedures**
Reusable encapsulated logic for:
- Updating supplier, product, or employee details  
- Deleting inactive/expired data  
- Fetching records by parameters (e.g., suppliers by country, products by category)  

### 4. **DCL (Data Control Language)**
User permission management:
- Granting `SELECT` and `UPDATE` rights to role-based users (e.g., `supply_manager`, `customer_manager`, `sales_manager`).  

### 5. **TCL (Transaction Control Language)**
Data integrity enforcement:
- Demonstrates `START TRANSACTION`, `SAVEPOINT`, `COMMIT`, and `ROLLBACK`.  
- Includes **intentional errors** to illustrate rollback scenarios.  

### 6. **Triggers**
Automation for:
- Logging changes (price updates, salary updates, new entries)  
- Validating constraints (no negative stock, no invalid phone numbers, etc.)  
- Auto-updating metadata (e.g., `last_updated` timestamps)  

### 7. **Window Functions**
Advanced analytics:
- Ranking by creation date, price, salary, etc.  
- Running totals (sales, stock, salaries)  
- Percentage calculations (category/product contribution, supplier share)  

---

## üß† Learning Objectives
By completing this phase, you will learn to:
- Write **maintainable SQL scripts** for large-scale systems.  
- Apply **automation via triggers** for real-time data handling.  
- Manage **transactions** safely using rollback and savepoints.  
- Implement **role-based access control** with DCL.  
- Use **window functions** for advanced reporting.  

---

## üìÅ File Structure
- **phase4allcopy.txt**: Contains all SQL scripts organized by table.  
  Each block includes:
  - 3‚Äì5 Views  
  - 3‚Äì5 CTEs  
  - 2‚Äì3 Stored Procedures  
  - TCL examples with commit/rollback  
  - DCL grant statements  
  - 3 Triggers  
  - 2‚Äì3 Window Function queries  

---

## üìÅ File Structure
**Phase 4.sql**: Contains all SQL scripts for views, CTEs, stored procedures, triggers, and transactions.  

- Organized into blocks per table (e.g., Products, Customers, Orders, etc.)  
- Each query is clearly labeled with:  
  - Query number  
  - Type  
  - Description  

---

## üõ†Ô∏è How to Use
1. Import your full database schema and sample data (**Tables 1‚Äì25**) into MySQL.  
2. Run **Phase 4.sql** sequentially or execute queries table-wise.  
3. Review the outputs and logs generated by **triggers** and **stored procedures**.  
4. Modify and expand queries for your own use cases or academic submissions.  

---

## üìö Example Tables Included
- Products  
- Customers  
- Categories  
- Orders  
- Order_Items  
- Suppliers  
- Payments  
- Payment_Methods  
- Addresses  
- *(And more... up to 25 total)*  

---

## ‚úÖ Status
- ‚úÖ Completed and tested on **MySQL**  
- ‚ö†Ô∏è Ensure `DELIMITER` commands are properly handled when running **triggers** and **stored procedures**.  
